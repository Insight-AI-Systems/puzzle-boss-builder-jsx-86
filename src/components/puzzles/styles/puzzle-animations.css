/* Puzzle piece animations */
.puzzle-piece {
  transition: all 0.2s ease-out;
  position: relative; /* Ensure position context for z-index */
}

.puzzle-piece-dragging {
  transition: transform 0.1s ease-out;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

/* Correctly placed pieces should have the lowest z-index */
.puzzle-piece-correct {
  box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
  animation: correct-piece 0.5s ease;
}

/* Apply a distinctive visual treatment to make trapped pieces more visible */
.puzzle-piece.trapped {
  box-shadow: 0 0 15px rgba(255, 0, 0, 0.9) !important;
  animation: trapped-piece-pulse 1s infinite alternate;
  transform: scale(1.15) !important; /* Force trapped pieces to be larger */
  border: 2px solid red !important;
  pointer-events: auto !important; /* Ensure pieces can be clicked */
}

.puzzle-piece-hint {
  animation: hint-piece 2s infinite;
}

/* Puzzle completion animation */
.puzzle-complete {
  animation: complete-puzzle 2s ease;
}

/* Keyframes for piece movements */
@keyframes correct-piece {
  0% {
    transform: scale(1);
    box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
  }
  50% {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.7);
  }
}

@keyframes hint-piece {
  0%, 100% {
    box-shadow: 0 0 3px rgba(0, 179, 179, 0.3);
  }
  50% {
    box-shadow: 0 0 10px rgba(0, 179, 179, 0.8);
  }
}

@keyframes trapped-piece-pulse {
  0% {
    box-shadow: 0 0 8px rgba(255, 0, 0, 0.7);
    opacity: 0.9;
  }
  100% {
    box-shadow: 0 0 20px rgba(255, 0, 0, 1);
    opacity: 1;
  }
}

@keyframes complete-puzzle {
  0% {
    box-shadow: 0 0 0 rgba(255, 215, 0, 0);
  }
  50% {
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
  }
  100% {
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
  }
}

/* Touch specific enhancements */
@media (pointer: coarse) {
  .puzzle-piece:active {
    transform: scale(1.05);
  }
  
  /* Larger touch targets */
  .puzzle-piece {
    touch-action: none; /* Prevent browser handling of gestures */
  }
  
  /* Mobile-friendly direction controls */
  .direction-button-touch {
    min-width: 44px;
    min-height: 44px;
  }
}

/* Device-specific adjustments */
@media (max-width: 480px) {
  .puzzle-grid-mobile {
    gap: 2px;
    padding: 4px;
  }
  
  .puzzle-piece-mobile {
    border-radius: 4px;
  }
}

/* Smooth transition for pinch-to-zoom */
.transform-gpu {
  transform-origin: center;
  will-change: transform;
  backface-visibility: hidden;
}
